PDF: HW_2_Ackerberg_BBL.pdf
Number of pages: 5
================================================================================

--- Page 1 ---

Empirical IO Homework
Dynamic Entry/Exit game
Suppose that in each time period, a set of ﬁrms producing homogeneous products play a simultaneous
move Nash quantity-setting game. The market-level inverse demand curve in market in time t is given by
pt = 10 −Qt + xt
where Qt is the total quantity produced by all the ﬁrms, and xt is a demand shifter. Assume that all ﬁrms
have 1) a marginal cost of 0, and 2) a ﬁxed cost of operation of 5 per-period.
1)
Given these cost and demand primitives, derive a equation expressing the Nash-equilibrium single
period proﬁts per ﬁrm, as depending on the total number of ﬁrms Nt and the demand shifter xt.
In other
words, derive the formula for π(Nt, xt). This formula will be useful for the computations later.
Next, consider the dynamic entry and exit process. First, assume that the demand shifter xt takes on
3 possible values {−5, 0, 5}, and that this evolves over time according to the following ﬁrst order Markov
transition matrix (e.g. given xt = 5, the probability that xt+1 = −5 is 0.2):
xt+1
-5
0
5
-5
0.6
0.2
0.2
xt
0
0.2
0.6
0.2
5
0.2
0.2
0.6
For the exit process, assume that in each period, each active ﬁrm gets a stochastic sell oﬀvalue:
µit ∼N(µ, σ2
µ)
This value µit is assumed to be private information for the ﬁrm, and it is assumed to be i.i.d. across ﬁrms
and time. If a ﬁrm decides to exit at period t, it receives current payoﬀof just µit (note that this is slightly
diﬀerent than the model in class) and is then out of the market forever. This implies that the value function
for an active ﬁrm is
V (Nt, xt, µit) =
max
dit∈{0,1}
©
µit, π(Nt, xt) + 0.9E
£
V (Nt+1, xt+1, µit+1)|Nt, xt, dit = 1
¤ª
where dit = 0 if the ﬁrm exits and dit = 1 if the ﬁrm remains in the market.
For the entry process, assume that in each period, there is one "potential entrant" into the market. This
potential entrant is endowed with a stochastic entry cost:
γit ∼N(γ, σ2
γ)
that they must pay to enter the market (γit is also private information to the entrant and assumed iid across
time).
If the ﬁrm decides to enter at t, their single period payoﬀs at t are −γit - i.e. they only begin to
produce and make proﬁts in the next period. If the ﬁrm decides not to enter at t, they disappear from the
market forever. This implies that the value function for a potential entrant is:
V E(Nt, xt, γit) =
max
eit∈{0,1}
©
0, −γit + 0.9E
£
V (Nt+1, xt+1, γit+1)|Nt, xt, eit = 1
¤ª
where eit = 1 if the ﬁrm enters and eit = 0 if the ﬁrm does not enter the market.
1


--- Page 2 ---

We will focus attention on symmetric Markov-Perfect Nash Equilibria of this game that take the following
"cutoﬀ" form:
For an incumbent Firm:
dit =
½ 0
if µit > µ(Nt, xt)
1
if µit ≤µ(Nt, xt)
For a potential entrant:
eit =
½ 0
if γit > γ(Nt, xt)
1
if γit ≤γ(Nt, xt)
2) Why does a cutoﬀequilbrium make intuitive sense in this setup?
Assume that the maximum number of ﬁrms in the market is 5 (i.e. when Nt = 5, assume that the
entry cost γit is ∞with probability 1.)
This means that there are 18 possible values of the state i.e.
Nt ∈{0, 1, 2, ...5}, xt ∈{−5, 0, 5}.
Therefore, equilibrium can be summarized by 36 cutoﬀnumbers,
µ(Nt, xt) at each of the 18 possible states, and γ(Nt, xt) at each of the 18 possible states.
Actually, note
that only 30 of these numbers are relevant, since in states where Nt = 0 there are no incumbents (so µ(0, xt)
is irrelevant), and in states where Nt = 5 there can be no entry, (so γ(5, xt) is irrelevant).
Also note that the 2 value functions can be alternatively written as:
V (Nt, xt, µit) =
max
dit∈{0,1}
⎧
⎨
⎩µit , π(Nt, xt) + 0.9
X
Nt+1
X
xt+1
Z
V (Nt+1, xt+1, µit+1)p(dµit+1) Pr(xt+1|xt) Pr(Nt+1|Nt, xit, dit = 1)
V E(Nt, xt, γit) =
max
eit∈{0,1}
⎧
⎨
⎩0, −γit + 0.9
X
Nt+1
X
xt+1
Z
V (Nt+1, xt+1, µit+1)p(dµit+1) Pr(xt+1|xt) Pr(Nt+1|Nt, xt, eit = 1)
⎫
⎬
⎭
Then, deﬁning
V (Nt, xt) =
Z
V (Nt, xt, µit)p(dµit)
we can write the value functions as:
V (Nt, xt, µit) =
max
dit∈{0,1}
⎧
⎨
⎩µit, π(Nt, xt) + 0.9
X
Nt+1
X
xt+1
V (Nt+1, xt+1) Pr(xt+1|xt) Pr(Nt+1|Nt, xt, dit = 1)
⎫
⎬
⎭
V E(Nt, xt, γit) =
max
eit∈{0,1}
⎧
⎨
⎩0, −γit + 0.9
X
Nt+1
X
xt+1
V (Nt+1, xt+1) Pr(xt+1|xt) Pr(Nt+1|Nt, xt, eit = 1)
⎫
⎬
⎭
Note that V (Nt, xt) is not deﬁned when Nt = 0 (this follows because V (Nt, xt, µit) is not deﬁned at Nt = 0,
i.e. there is no value function for an incument at Nt = 0 because there is no incumbent with Nt = 0). .
3) Describe (at an intuitive level) what V (Nt, xt) measures.
How does this relate to the alternative
speciﬁc value functions of Rust (1987)?
4) Assume that the parameters of the model take the values: γ = 5, σ2
γ = 5, µ = 5, and σ2
µ = 5. Use the
following iterative process to solve for the equilibrium (lets assume at the moment that it is unique). Note
that this process is related to, but slightly diﬀerent than the procedure I outlined in class:
2


--- Page 3 ---

1. Guess µ(Nt, xt), γ(Nt, xt), and V (Nt, xt) (note: this is just 3 vectors of 15 numbers, since µ(Nt, xt)
and V (Nt, xt) are not deﬁned when Nt = 0, and γ(Nt, xt) is not deﬁned when Nt = 5 )
2. Using µ(Nt, xt) and γ(Nt, xt), compute the transition matrices Pr(Nt+1|Nt, xt, dit = 1) and Pr(Nt+1|Nt, xt, eit =
1). There should be six of these matrices (for dit = 1, there should be 1 for each of the 3 xt’s, and for
eit = 1 there should be one for each of the 3 xt’s ) Why are the two matrices diﬀerent (for a given xt)?
3. Compute
Ψ1(Nt, xt)
=
0.9
X
Nt+1
X
xt+1
V (Nt+1, xt+1) Pr(xt+1|xt) Pr(Nt+1|Nt, xt, dit = 1)
Ψ2(Nt, xt)
=
0.9
X
Nt+1
X
xt+1
V (Nt+1, xt+1) Pr(xt+1|xt) Pr(Nt+1|Nt, xt, eit = 1)
4. Solve for "new" optimal cutoﬀs at each state using:
µ0(Nt, xt)
=
π(Nt, xt) + Ψ1(Nt, xt)
γ0(Nt, xt)
=
Ψ2(Nt, xt)
Why do these equations tell us the new optimal cutoﬀs (given the computed values of Pr(Nt+1|Nt, xt, dit =
1) and Pr(Nt+1|Nt, xt, eit = 1))?
5. Solve for "new" V
0(Nt, xt) at each state using:
V
0(Nt, xt)
=
Z
V (Nt, xt, µit)p(dµit)
=
Z
max
dit∈{0,1}
⎧
⎨
⎩µit, π(Nt, xt) + .9
X
Nt+1
X
xt+1
V (Nt+1, xt+1) Pr(xt+1|xt) Pr(Nt+1|Nt, xt, dit=1)
⎫
⎬
⎭p(dµit)
=
Z
max
dit∈{0,1} {µit, π(Nt, xt) + Ψ1(Nt, xt)} p(dµit)
=
∙
1 −Φ(π(Nt, xt) + Ψ1(Nt, xt) −µ
σµ
)
¸ ⎡
⎣µ + σµ ∗
⎛
⎝
φ( π(Nt,xt)+Ψ1(Nt,xt)−µ
σµ
)
1 −Φ( π(Nt,xt)+Ψ1(Nt,xt)−µ
σµ
)
⎞
⎠
⎤
⎦
+Φ(π(Nt, xt) + Ψ1(Nt, xt) −µ
σµ
) [π(Nt, xt) + Ψ1(Nt, xt)]
where φ and Φ are the standard normal pdf and cdf. Where is the last equality coming from?
6. With the new µ0(Nt, xt), γ0(Nt, xt), and V
0(Nt, xt), go back to step 1.
7. Iterate procedure until convergence.
5) Try resolving for the equilibrium (question 4) starting with 5 diﬀerent guesses of the initial values of
µ(Nt, xt), γ(Nt, xt), and V (Nt, xt). Do you ﬁnd any evidence of multiple equilibria?
6) At the equilibrium (or one of the equilibria - if there are multiple equilibria, you can pick whichever
one you like), tell me the values µ(3, 0), γ(3, 0), V (3, 0), and V (3, 0, −2).
7) Consider a market starting out with 0 ﬁrms and xt = 0. Simulate this structure of this market 10000
periods into the future.
You can do this using only the equilibrium µ(Nt, xt) and γ(Nt, xt) functions you
3


--- Page 4 ---

have computed (along with Pr(xt+1|xt)) .
Note that you will need to take draws from the µit and γit
distributions to do this. What is the average number of ﬁrms in the market across these 10000 periods?
8) Suppose the government decided to implement a 5 unit entry tax.
What happens to the average
number of ﬁrms in equilibrium? (note: you will need to resolve for a new equilibrium to do this). Can you
answer this question if there are multiple equilibria? Why or why not?
9) Using the simulated data from Question 7), use a BBL-like estimator to estimate γ, σ2
γ, µ, and σ2
µ. In
other words assume you know everything about the model (demand, ﬁxed and marginal costs, discount factor,
p(xt+1|xt) distribution) except for these 4 parameters, and estimate them. More speciﬁcally, estimation
should proceed as follows:
A) Estimate the reduced form expected policy functions, bd(Nt, xt) and be(Nt, xt), directly from the data.
At each state, these policy functions tell us, respectively, 1) the probability that any speciﬁc incumbent
stays in the market, and 2) the probability that the potential entrant enters.
You can estimate these with
a frequency simulator, e.g. bd(Nt, xt) is the proportion of all incumbents in the data at state (Nt, xt) who
decided to stay in the market, be(Nt, xt) is the proportion of times in the data where at state (Nt, xt), the
entrant decided to enter.
Note that you do not need to estimate bd(Nt, xt) when Nt = 0, nor do you need
to estimate be(Nt, xt) when Nt = 5 (if you want, you can just set bd(0, xt) = be(5, xt) = 0). If there are other
states (Nt, xt) that are never reached in the dataset, use the values of bd(Nt, xt) and be(Nt, xt) from a nearby
state that was observed in the data.
Alternatively, you can estimate bd(Nt, xt) and be(Nt, xt) using a probit
or logit model with a high order polynomial in Nt and xt.
B) Guess the parameters γ, σ2
γ, µ, and σ2
µ.
At each possible value of the state, use bd(Nt, xt), be(Nt, xt),
π(Nt, xt) and Pr(xt+1|xt) to "forward" simulate the PDV of one of the incumbents (call this ﬁrm "Firm 1")
conditional on that ﬁrm deciding not to exit in the initial period (clearly, you can’t do this at states where
Nt = 0).
This involves simulating 1) decisions of potential entrants in the current period and the future,
2) decisions of ﬁrms other than Firm 1 in the current period and the future, and 3) decisions of Firm 1 in
the future (since we are already conditioning on Firm 1 not exiting in the current period, we don’t need
to simulate Firm 1’s current decision). To simulate all these decisions, you will need to take draws of µit
and γit (these draws will obviously depend on the parameters.
Create them by taking draws from
N(0, 1)’s, multiplying by σµ (or σγ) and adding µ (or γ).
Importantly (and like we did in the
BLP problem set), hold the underlying N(0, 1) draws constant as the parameters change (also
hold the draws on the xt process the same across simulations).
Given such draws, an incumbent stays in
the market if
Φ
µµit −µ
σµ
¶
≤bd(Nt, xt)
and an entrant enters if
Φ
µγit −γ
σγ
¶
≤be(Nt, xt)
Note that these equations are implied by the cutoﬀequilibrium, because if, e.g. bd(Nt, xt) = 0.25, then ﬁrms
with µit’s in the lower quartile of the distribution must be the ones that are staying in the market. Simulate
forward in time until either Firm 1 exits the market (or until t gets very large, e.g. 100) and add up Firm
1’s total discounted proﬁts. Note that if Firm 1 eventually exits, you will need to add her simulated µit in
that period (appropriately discounted) into total proﬁts to compute the simulated total stream of proﬁts.
C) Do the above forward simulation process 50 times for one of the incuments in each of the 15 states
(i.e. all the states except those with Nt = 0), and average across these 50 runs to get an expectation of this
PDV. Call these values Λ(Nt, xt | γ, σ2
γ, µ, σ2
µ).
4


--- Page 5 ---

D) Note that according to the model, a ﬁrm will stay in the market if
µit < Λ(Nt, xt|γ, σ2
γ, µ, σ2
µ)
which, given the distribution of µit, should happen with probability
Pr(incumbent "stays in" at Nt, xt|γ, σ2
γ, µ, σ2
µ) = Φ
Ã
Λ(Nt, xt|γ, σ2
γ, µ, σ2
µ) −µ
σµ
!
Therefore, if the simulations of Λ(Nt, xt | γ, σ2
γ, µ, σ2
µ) were done at the true parameters γ, σ2
γ, µ, σ2
µ, one
would expect
Φ
Ã
Λ(Nt, xt|γ, σ2
γ, µ, σ2
µ) −µ
σµ
!
≈bd(Nt, xt)
at every Nt, xt
(1)
E) Do a similar forward simulation process to compute the expected PDV of future proﬁts for a potential
entrant in each of the 15 states (ignore states where Nt = 5). More speciﬁcally, what you want to simulate
here is the expected PDV of a potential entrant entering, net of the entry cost γit (by "net of the entry cost
γit" I mean that you should not add the −γit for the entering period into the total PDV). Denote these
simulated values for each of the 15 states by ΛE(Nt, xt | γ, σ2
γ, µ, σ2
µ). Similar to Step 4), according to the
model, a potential entrant will enter if
ΛE(Nt, xt|γ, σ2
γ, µ, σ2
µ) > γit
which, given the distribution of γit, should happen with probability
Pr(entrant enters at Nt, xt|γ, σ2
γ, µ, σ2
µ) = Φ
Ã
ΛE(Nt, xt|γ, σ2
γ, µ, σ2
µ) −γ
σγ
!
Therefore, if the simulations of ΛE(Nt, xt | γ, σ2
γ, µ, σ2
µ) were done at the true parameters γ, σ2
γ, µ, σ2
µ, one
would expect
Φ
Ã
ΛE(Nt, xt|γ, σ2
γ, µ, σ2
µ) −γ
σγ
!
≈be(Nt, xt)
at every Nt, xt
(2)
F) Given that equations (1) and (2) should hold at the true parameters, we will base estimation on them.
More speciﬁcally, you should use a search procedure to ﬁnd the γ, σ2
γ, µ, and σ2
µ that minimizes the following
minimum distance criterion:
min
5
X
Nt=1
X
xt
Ã
Φ
Ã
Λ(Nt, xt|γ, σ2
γ, µ, σ2
µ) −µ
σµ
!
−bd(Nt, xt)
!2
+
4
X
Nt=0
X
xt
Ã
Φ
Ã
ΛE(Nt, xt|γ, σ2
γ, µ, σ2
µ) −γ
σγ
!
−be(Nt, xt)
!2
10) You do not need to compute standard errors for your estimate (note that you wouldn’t be able to use
standard minimum distance variance formulas, since those do not take into account the estimation error in
Λ(Nt, xt|γ, σ2
γ, µ, σ2
µ) and ΛE(Nt, xt|γ, σ2
γ, µ, σ2
µ) (due to the fact that these quantities depend on bd(Nt, xt)
and be(Nt, xt)). Does your estimation procedure do a good job of estimating the true parameters?
5


